# Consonant Labs Control Plane - Environment Configuration
# Copy this file to .env and configure for your environment

# ============================================================================
# Server Configuration
# ============================================================================

# Node environment: development, test, or production
NODE_ENV=development

# HTTP server port
PORT=3000

# HTTP server host (0.0.0.0 for all interfaces, localhost for local only)
HOST=0.0.0.0

# Log level: trace, debug, info, warn, error, fatal
LOG_LEVEL=debug

# ============================================================================
# Database Configuration
# ============================================================================

# Database connection URL
# Provider is auto-detected from URL at runtime
#
# PostgreSQL example:
# DATABASE_URL="postgresql://user:password@localhost:5432/consonant"
#
# SQLite example (for local development):
# DATABASE_URL="file:./local.db"
DATABASE_URL="postgresql://postgres:postgres@localhost:5432/consonant"

# TimescaleDB connection URL for time-series data (telemetry, request timelines)
# This should be a SEPARATE database for independent scaling
# In production, use a dedicated TimescaleDB instance
# For local development, you can use the same PostgreSQL instance with a different database
TIMESCALE_DB_URL="postgresql://postgres:postgres@localhost:5432/consonant_timeseries"

# ============================================================================
# Security Configuration
# ============================================================================

# JWT secret for signing authentication tokens (minimum 32 characters)
# Generate with: openssl rand -base64 32
# Keep this secret and rotate periodically
JWT_SECRET="your-secret-key-here-minimum-32-characters-long-change-this"

# ============================================================================
# Redis Configuration
# ============================================================================

# Redis connection URL for rate limiting and caching
REDIS_URL="redis://localhost:6379"

# Redis key prefix to avoid collisions
REDIS_PREFIX="consonant:"

# ============================================================================
# gRPC Server Configuration
# ============================================================================

# gRPC server port for cluster connections
GRPC_PORT=50051

# gRPC server host
GRPC_HOST=0.0.0.0

# Enable TLS for gRPC connections (false for development, true for production)
GRPC_TLS_ENABLED=false

# Path to TLS certificate file (required if TLS enabled)
# GRPC_TLS_CERT=/path/to/cert.pem

# Path to TLS private key file (required if TLS enabled)
# GRPC_TLS_KEY=/path/to/key.pem

# Maximum connection age in milliseconds (1 hour)
GRPC_MAX_CONNECTION_AGE=3600000

# Maximum connection idle time in milliseconds (5 minutes)
GRPC_MAX_CONNECTION_IDLE=300000

# Keepalive time in milliseconds (30 seconds)
GRPC_KEEPALIVE_TIME=30000

# Keepalive timeout in milliseconds (10 seconds)
GRPC_KEEPALIVE_TIMEOUT=10000

# ============================================================================
# OpenTelemetry Configuration
# ============================================================================

# Enable OpenTelemetry instrumentation
OTEL_ENABLED=true

# OTLP exporter endpoint (HTTP)
# For Jaeger: http://localhost:4318
# For Tempo: http://localhost:4318
OTEL_ENDPOINT="http://localhost:4318"

# Service name for telemetry
OTEL_SERVICE_NAME="consonant-control-plane"

# Service version for telemetry
OTEL_SERVICE_VERSION="1.0.0"

# Environment name for telemetry (development, staging, production)
OTEL_ENVIRONMENT="development"

# ============================================================================
# Inngest Configuration
# ============================================================================

# Inngest event key for authentication
# Use 'local' for development, get production key from Inngest dashboard
INNGEST_EVENT_KEY="local"

# Inngest signing key for webhook verification (optional in development)
# INNGEST_SIGNING_KEY="your-signing-key-here"

# Inngest app ID
INNGEST_APP_ID="consonant-control-plane"

# ============================================================================
# Security Configuration
# ============================================================================

# CORS allowed origins (comma-separated, * for all)
CORS_ORIGIN="*"

# JWT secret for token signing (optional, not implemented yet)
# JWT_SECRET="your-secret-key-here-minimum-32-characters"

# Bcrypt rounds for password hashing (10-15, higher is more secure but slower)
BCRYPT_ROUNDS=12

# ============================================================================
# Rate Limiting Configuration
# ============================================================================

# Default rate limit (requests per minute)
RATE_LIMIT_MAX=100

# Rate limit window in milliseconds (1 minute)
RATE_LIMIT_WINDOW=60000

# ============================================================================
# Feature Flags
# ============================================================================

# Enable API key authentication
FEATURE_API_KEYS=true

# Enable cluster authentication
FEATURE_CLUSTER_AUTH=true

# Enable telemetry storage
FEATURE_TELEMETRY=true
